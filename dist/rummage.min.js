!function(e){"function"==typeof define&&define.amd?define("rummage",["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")(window)):e(jQuery)}(function(e){e.fn.rummage=function(a,t){var s=e.extend({},e.fn.rummage.objDefaultOptions,t),r=function(e,a){return s.matchCase===!0?-1!==a.indexOf(e):-1!==a.toLowerCase().indexOf(e.toLowerCase())},l=function(e){return""===e.replace(/[\s\t\r\n]*/g,"")};return this.each(function(){var t=e(this),n=t[0].nodeName.toLowerCase();if("input"!==n&&"select"!==n)throw"Rummaging can only be called on INPUT and SELECT elements";var c;if(!("object"==typeof a&&(e(a)instanceof jQuery||a.jquery)||e(a).length))throw"Can't find anything to rummage";a=e(a),c=a.find("["+s.attribute+"]");var o=c.filter(":not("+s.exclude+")").length,h=function(){var n=t.val(),h=0,u=c.filter(":not("+s.exclude+")");if(l(n))h=u.filter(":not("+s.exclude+")").length,u.addClass(s.matchClass).removeClass(s.noMatchClass),a.removeClass(s.searchingClass+" "+s.noResultsClass);else if(s.regex)try{var i=new RegExp(n,"m");a.hasClass(s.searchingClass)||a.addClass(s.searchingClass),u.each(function(){var a=e(this),t=a.attr(s.attribute),r=!1;(i.test(t)||s.searchText&&i.test(a.text()))&&(r=!0),r?(h++,l(s.matchClass)||a.addClass(s.matchClass),l(s.noMatchClass)||a.removeClass(s.noMatchClass)):(l(s.noMatchClass)||a.addClass(s.noMatchClass),l(s.matchClass)||a.removeClass(s.matchClass))})}catch(m){h=u.find("."+s.matchClass).length}else{var C=s.matchCase===!0?n.match(/[\+\-]?("([^"]*)"|'([^']*)')/g):n.match(/[\+\-]?("([^"]*)"|'([^']*)')/gi),f=s.matchCase===!0?n.replace(/[\+\-]?("[^"]*"|'[^']*')/g,""):n.replace(/[\+\-]?("[^"]*"|'[^']*')/gi,""),g=C?f.split(" ").concat(C):f.split(" ");a.hasClass(s.searchingClass)||a.addClass(s.searchingClass),u.each(function(){var a=e(this),t=a.attr(s.attribute),c=0;if(s.exactMatch===!0)c=s.searchText?n===a.text()?1:0:n===a.attr(s.attribute)?1:0;else{s.searchText&&(t=""===t?a.text():t+","+a.text());for(var o=0,u=g.length;u>o;o++){var i=g[o];if(""!==i){if(i.length>1&&"+"===i.substr(0,1)&&!r(i.substr(1).replace(/^"/,"").replace(/"$/,""),t)){c=0;break}if(i.length>1&&"-"===i.substr(0,1)&&r(i.substr(1).replace(/^"/,"").replace(/"$/,""),t)){c=0;break}for(i=i.replace(/^"/,"").replace(/"$/,"");r(i,t);){var m=t.indexOf(i);if(t=t.substring(0,m)+t.substr(m+i.length),c++,!s.score)break}}}}c>0?(h++,l(s.matchClass)||a.addClass(s.matchClass),l(s.noMatchClass)||a.removeClass(s.noMatchClass)):(l(s.noMatchClass)||a.addClass(s.noMatchClass),l(s.matchClass)||a.removeClass(s.matchClass)),s.score&&a.attr("data-rummagescore",c)})}0===h?a.addClass(s.noResultsClass):a.removeClass(s.noResultsClass),("object"==typeof s.results&&(e(s.results)instanceof jQuery||s.results.jquery)||e(s.results).length)&&e(s.results).text(h),("object"==typeof s.total&&(e(s.total)instanceof jQuery||s.total.jquery)||e(s.total).length)&&u.length!==o&&(o=u.length,e(s.total).text(o))};switch(s.searchOnLoad&&h(),n){case"input":t.off("keyup search").on("keyup search",h);break;case"select":t.off("click change").on("click change",h)}t.on({"rummage.reindex":h}),("object"==typeof s.total&&(e(s.total)instanceof jQuery||s.total.jquery)||e(s.total).length)&&e(s.total).text(o)})},e.fn.rummage.objDefaultOptions={attribute:"data-rummage",exclude:".rummage-exclude",exactMatch:!1,matchCase:!1,matchClass:"",noMatchClass:"rummage-nomatch",noResultsClass:"rummage-noresults",regex:!1,results:"",score:!1,searchingClass:"rummage-searching",searchOnLoad:!0,searchText:!1,total:""}});